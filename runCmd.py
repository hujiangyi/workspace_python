import matplotlib.pyplot as pl
import numpy as np

param_30_1 = np.array([
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    30.0 +27.0j,
    37.0 +1.0j,
    57.0 +2.0j,
    -62.0 -35.0j,
    124.0 +67.0j,
    -130.0 -4.0j,
    353.0 +170.0j,
    32759.0 +0.0j,
    -448.0 -104.0j,
    226.0 +135.0j,
    -134.0 -68.0j,
    69.0 +69.0j,
    -31.0 +63.0j,
    32.0 +3.0j,
    -32.0 +63.0j,
    33.0 +36.0j,
    31.0 +37.0j,
    30.0 +29.0j,
    62.0 -30.0j,
    -32.0 +62.0j,
    2.0 -33.0j,
    69.0 +33.0j,
    106.0 -2.0j,
    -4.0 +98.0j
]);


param_30_2 = np.array([
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    8.0 +63.0j,
    -55.0 +16.0j,
    78.0 -4.0j,
    -98.0 -30.0j,
    211.0 +40.0j,
    -352.0 -59.0j,
    703.0 +193.0j,
    32744.0 +0.0j,
    -739.0 -128.0j,
    350.0 +141.0j,
    -164.0 -16.0j,
    120.0 +76.0j,
    -151.0 +24.0j,
    61.0 +43.0j,
    14.0 -17.0j,
    3.0 +26.0j,
    -9.0 +66.0j,
    7.0 -107.0j,
    -29.0 +88.0j,
    0.0 -58.0j,
    2.0 +3.0j,
    43.0 +28.0j,
    112.0 +32.0j,
    -51.0 +31.0j
]);
param_20_1 = np.array([
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +3.0j,
    -2.0 +0.0j,
    -2.0 +3.0j,
    -2.0 +0.0j,
    5.0 +0.0j,
    -3.0 -1.0j,
    11.0 +8.0j,
    2047.0 +0.0j,
    -18.0 -7.0j,
    11.0 +3.0j,
    -5.0 -2.0j,
    3.0 +2.0j,
    -4.0 +0.0j,
    2.0 +2.0j,
    3.0 -2.0j,
    4.0 +0.0j,
    4.0 +1.0j,
    -5.0 -4.0j,
    1.0 +2.0j,
    1.0 -3.0j,
    -1.0 +2.0j,
    0.0 -2.0j,
    4.0 -7.0j,
    1.0 +3.0j
]);
param_20_2 = np.array([
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    0.0 +0.0j,
    -7.0 +3.0j,
    0.0 -4.0j,
    -5.0 -1.0j,
    11.0 -8.0j,
    -17.0 +5.0j,
    31.0 -7.0j,
    -62.0 +15.0j,
    2044.0 -4.0j,
    54.0 -15.0j,
    -27.0 +6.0j,
    15.0 -5.0j,
    -6.0 +6.0j,
    5.0 +4.0j,
    -5.0 -2.0j,
    0.0 +1.0j,
    0.0 -2.0j,
    -1.0 +6.0j,
    0.0 -7.0j,
    4.0 +5.0j,
    -1.0 -3.0j,
    5.0 -2.0j,
    -2.0 +1.0j,
    5.0 -9.0j,
    -1.0 +7.0j
]);

shift_30_1 = np.fft.fftshift(param_30_1);
shift_30_2 = np.fft.fftshift(param_30_2);
shift_20_1 = np.fft.fftshift(param_20_1);
shift_20_1 = np.fft.fftshift(param_30_2);

guiyi_30_1 = shift_30_1 / shift_30_1[0];
guiyi1_30_1 = guiyi_30_1 / 5;
guiyi_30_2 = shift_30_2 / shift_30_2[0];
guiyi1_30_2 = guiyi_30_2 / 5;
guiyi_20_1 = shift_20_1 / shift_20_1[0];
guiyi1_20_1 = guiyi_20_1 / 5;
guiyi_20_2 = shift_20_1 / shift_20_1[0];
guiyi1_20_2 = guiyi_20_2 / 5;

result_30_1 = np.fft.fft(guiyi1_30_1);
result_30_2 = np.fft.fft(guiyi1_30_2);
result_20_1 = np.fft.fft(guiyi1_20_1);
result_20_2 = np.fft.fft(guiyi1_20_2);



xz_30_20 = np.array([
    1.00791 +0.01833j,
    1.00927 +0.00302j,
    0.99898 +0.0155j,
    0.99635 -0.00311j,
    0.99036 +0.00591j,
    1.00249 +0.00083j,
    1.00556 +0.01471j,
    1.01266 -0.00343j,
    0.98932 +0.00799j,
    1.01029 +0.00875j,
    0.99559 +0.00273j,
    1.00096 +0.01341j,
    0.99088 +0.0064j,
    0.98943 +0.02026j,
    1.00229 +0.01261j,
    0.99294 +0.0037j,
    0.99866 +0.00762j,
    1.00401 -0.01661j,
    0.98875 -0.01133j,
    1.01509 +0.0004j,
    1.01849 -0.02205j,
    0.99823 -0.01499j,
    0.99902 -0.00693j,
    0.99407 -0.0123j,
    0.99116 -0.0098j,
    1.0027 -0.00666j,
    1.01398 -0.01714j,
    0.998 -0.01095j,
    1.00139 +0.00696j,
    0.99817 +0.00161j,
    0.99985 -0.00643j,
    0.98648 -0.0069j
]);

td_30_20 = np.fft.ifft(xz_30_20);

ishift_30_20 = np.roll(td_30_20, 15)
realResult = np.real(ishift_30_20);
imagResult = np.imag(ishift_30_20);
sRealResult = np.square(realResult);
sImagResult = np.square(imagResult);
addResult = np.add(sRealResult,sImagResult);
sqrtResult = np.sqrt(addResult);

tte = 0;
for x in np.nditer(sqrtResult):
    tte = tte + x;
mte = sqrtResult[15]
re = 10 * np.log10(mte / (tte - mte))